では、19.5節から説明し続けます。さっき、前田さんはETSの基本的な操作を紹介しました。19.5節から、もう一つデータを格納するモジュールDETSを紹介します。DETSは、メモリにデータを保存する代わりに、ハードディスクにデータを保存します。各DTESファイルは最大2GBまで可能です。使用する前にDETSファイルをopenする必要があります。そしてそれを使用した後、それはcloseすべきです。DETSファイルをcloseしないと、次回にこのファイルを使用するときに、システムは自動的にこのファイルを修復します。この修復処理は非常に時間がかかるため、プログラムを終了する前にDETSファイルをclose必要があります。

DETSファイルを開くときに、このファイルにグローバル名前を付ける必要があります。複数のプロセスがDETSファイルを同じ名前とオプションで開くと、すべてのプロセスがDETSファイルをcloseするまでDTESファイルは常にopen状態のままです。次に、例を使ってDETSファイルを操作する方法を示します。この例で、2つ関数を定義しました。関数filename2indexはファイル名を整数にマップします。関数index2filenameは整数をファイル名にマップします。

この例では、DETSテーブルを作成しました。このDETSテーブルには以下の3つ種類のタプルが格納されます。
{free, N}
このタプルは、整数Nはまだ使用されていないを表します。次回は、新しいファイルを整数にマップするときは、このファイルをNにマップします。
{FileNameBin, K}
このタプルは、ファイルFileNameBinが整数Kにマップされていることを示します。
{K, FileNameBin}
このタプルは、整数KがファイルFileNameBinにマップされていることを示します。

プログラムの効率を向上させるために、毎回新しいファイルFを整数Kにマップする時に、{F,K}と{K,F}の2つのタプルがDETSテーブルに追加されます。
